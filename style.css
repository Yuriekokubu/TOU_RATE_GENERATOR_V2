@import url('https://fonts.googleapis.com/css2?family=Sarabun:wght@400;600&display=swap');

:root {
    --bg-color: #f0f0f0;
    --primary-color: #5a7d9a; /* A softer blue */
    --text-color: #333;
    --shadow-light: #ffffff;
    --shadow-dark: #d1d9e6;
    --border-radius: 12px;
    --spacing: 20px;
}

body {
    font-family: 'Sarabun', sans-serif;
    background-color: var(--bg-color);
    color: var(--text-color);
    display: flex;
    justify-content: center;
    align-items: flex-start; /* Align to top */
    min-height: 100vh;
    margin: 0;
    padding: var(--spacing);
    box-sizing: border-box;
}

.container {
    background-color: var(--bg-color);
    padding: calc(var(--spacing) * 1.5);
    border-radius: var(--border-radius);
    box-shadow: 10px 10px 20px var(--shadow-dark), -10px -10px 20px var(--shadow-light);
    width: 100%;
    max-width: 1200px; /* Increased max-width */
    box-sizing: border-box;
    text-align: center;
    margin-top: var(--spacing); /* Add some margin to the top */
}

h1 {
    color: var(--primary-color);
    margin-bottom: var(--spacing);
    font-weight: 600;
}

/* Drop Area Styles */
.drop-area {
    border: 3px dashed var(--shadow-dark);
    border-radius: var(--border-radius);
    padding: calc(var(--spacing) * 2);
    margin-bottom: var(--spacing);
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: inset 5px 5px 10px var(--shadow-dark), inset -5px -5px 10px var(--shadow-light);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-height: 150px;
}

.drop-area.drag-over {
    border-color: var(--primary-color);
    background-color: #e6e6e6;
    box-shadow: inset 3px 3px 6px var(--shadow-dark), inset -3px -3px 6px var(--shadow-light);
}

.drop-area .icon {
    font-size: 3em;
    margin-bottom: 10px;
    color: var(--primary-color);
}

.drop-area p {
    margin: 5px 0;
    color: var(--text-color);
    font-weight: 400;
}

#excelFile {
    display: none;
}

/* Controls Section */
.controls {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: var(--spacing);
    margin-bottom: var(--spacing);
    padding: var(--spacing);
    border-radius: var(--border-radius);
    box-shadow: inset 7px 7px 14px var(--shadow-dark), inset -7px -7px 14px var(--shadow-light);
    background-color: var(--bg-color);
}

.control-group {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
}

.controls label {
    margin-bottom: 8px;
    font-weight: 600;
    color: var(--primary-color);
}

/* Select and Checkbox Styles */
.select-wrapper {
    position: relative;
    width: 100%;
    background-color: var(--bg-color);
    border-radius: var(--border-radius);
    box-shadow: inset 3px 3px 6px var(--shadow-dark), inset -3px -3px 6px var(--shadow-light);
    overflow: hidden;
}

select {
    width: 100%;
    padding: 12px 15px;
    border: none;
    background-color: transparent;
    appearance: none; /* Remove default arrow */
    -webkit-appearance: none;
    -moz-appearance: none;
    font-family: 'Sarabun', sans-serif;
    font-size: 1em;
    color: var(--text-color);
    cursor: pointer;
    outline: none;
}

.select-wrapper::after {
    content: '‚ñº'; /* Custom arrow */
    position: absolute;
    top: 50%;
    right: 15px;
    transform: translateY(-50%);
    pointer-events: none;
    color: var(--primary-color);
}

/* --- Simplified Checkbox Styles --- */
.checkbox-group {
    display: flex;
    align-items: center; /* Align checkbox and text vertically */
    padding: 12px 0; /* Match vertical padding of other controls */
}

/* Hide the default browser checkbox */
.checkbox-group input[type="checkbox"] {
    position: absolute;
    opacity: 0;
    cursor: pointer;
    height: 0;
    width: 0;
}

.custom-checkbox {
    position: relative;
    padding-left: 30px; /* Space for the custom checkbox */
    cursor: pointer;
    font-weight: 600;
    color: var(--primary-color); 
    user-select: none;
    display: flex; 
    align-items: center;
    min-height: 20px; /* Adjust height as needed */
    margin-bottom: 0; 
}

/* This will be the visible box */
.custom-checkbox .icon-unchecked {
    position: absolute;
    left: 0;
    top: 50%;
    transform: translateY(-50%);
    height: 20px; /* Size of the custom box */
    width: 20px; /* Size of the custom box */
    background-color: #eee; /* Light gray box background */
    border: 1px solid #ccc; /* Simple gray border */
    border-radius: 4px; /* Slightly rounded corners */
    transition: background-color 0.2s, border-color 0.2s;
    z-index: 1; /* ‡∏≠‡∏¢‡∏π‡πà‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á */
}

/* This is the checkmark (‚úî) */
.custom-checkbox .icon-checked {
    position: absolute;
    left: 0px; 
    top: 50%;
    transform: translateY(-50%) scale(0); /* Hidden by default */
    height: 20px; 
    width: 20px; 
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 1.2em; 
    color: #28a745; 
    transition: transform 0.2s ease;
    text-shadow: 0 0 2px rgba(0,0,0,0.3);
    z-index: 2; /* ‡∏≠‡∏¢‡∏π‡πà‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô */
}

/* When the real checkbox is checked, show the checkmark and change box style */
.checkbox-group input[type="checkbox"]:checked + .custom-checkbox .icon-unchecked {
    background-color: #e0e0e0; 
    border-color: #28a745; 
}

.checkbox-group input[type="checkbox"]:checked + .custom-checkbox .icon-checked {
    transform: translateY(-50%) scale(1); /* Show the checkmark */
}
/* --- End Simplified Checkbox Styles --- */


/* Summary Boxes */
.summary-box {
    background-color: var(--bg-color);
    padding: var(--spacing);
    border-radius: var(--border-radius);
    box-shadow: 7px 7px 14px var(--shadow-dark), -7px -7px 14px var(--shadow-light);
    text-align: center;
    margin-bottom: var(--spacing);
}

.summary-box h3 {
    color: var(--primary-color);
    margin-top: 0;
    margin-bottom: 10px;
    font-weight: 600;
}

.summary-box p {
    margin: 5px 0;
    font-size: 1.1em;
}

.summary-box strong {
    color: var(--text-color);
}

.rate-summary-container {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: var(--spacing);
    margin-bottom: calc(var(--spacing) * 1.5);
}

/* Table Styles */
table {
    width: 100%;
    border-collapse: collapse;
    margin-top: var(--spacing);
    background-color: var(--bg-color);
    border-radius: var(--border-radius);
    overflow: hidden; /* Ensures rounded corners apply to content */
    box-shadow: 7px 7px 14px var(--shadow-dark), -7px -7px 14px var(--shadow-light);
}

th, td {
    padding: 12px 15px;
    text-align: left;
    border-bottom: 1px solid var(--shadow-dark);
}

th {
    background-color: var(--primary-color);
    color: var(--bg-color);
    font-weight: 600;
    position: sticky;
    top: 0;
    z-index: 10;
    cursor: pointer; /* Indicate sortable */
    transition: background-color 0.3s ease;
}

th.sortable {
    position: relative;
    padding-right: 15px; /* ‡∏•‡∏î‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏î‡πâ‡∏≤‡∏ô‡∏Ç‡∏ß‡∏≤‡∏•‡∏á ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô */
}

th:hover {
    background-color: #4a6c84; /* Slightly darker primary on hover */
}

tbody tr {
    transition: background-color 0.2s ease;
}

tbody tr:nth-child(even) {
    background-color: #e6e6e6; /* Lighter background for even rows */
}

tbody tr:hover {
    background-color: #d8d8d8; /* Highlight on hover */
    box-shadow: inset 2px 2px 5px var(--shadow-dark), inset -2px -2px 5px var(--shadow-light);
}

/* Specific row styles based on rate */
.peak {
    background-color: #ffcccc; /* Light red */
}
.off-peak {
    background-color: #ccffcc; /* Light green */
}
.holiday {
    background-color: #ccccff; /* Light blue */
}

.peak:hover {
    background-color: #ffb3b3;
}
.off-peak:hover {
    background-color: #b3ffb3;
}
.holiday:hover {
    background-color: #b3b3ff;
}

/* --- New Button Styles (General & Export Specific) --- */
/* General button styling */
.button {
    font-family: 'Sarabun', sans-serif; /* ‡πÉ‡∏ä‡πâ Font Sarabun ‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏Å‡∏≥‡∏´‡∏ô‡∏î */
    padding: 12px 25px;
    border: none;
    border-radius: var(--border-radius); /* ‡πÉ‡∏ä‡πâ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ border-radius */
    cursor: pointer;
    font-size: 1rem;
    font-weight: 600;
    transition: all 0.2s ease-in-out; /* ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ animation ‡∏î‡∏π‡∏ô‡∏∏‡πà‡∏°‡∏ô‡∏ß‡∏• */
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px; /* ‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á icon ‡∏Å‡∏±‡∏ö text ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ */
    color: var(--text-color); /* ‡πÉ‡∏ä‡πâ‡∏™‡∏µ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏•‡∏±‡∏Å */
}

/* Neumorphism Base Style for all buttons */
.button {
    background-color: var(--bg-color); /* ‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á container */
    box-shadow: 6px 6px 12px var(--shadow-dark), /* ‡πÄ‡∏á‡∏≤‡∏•‡πà‡∏≤‡∏á‡∏Ç‡∏ß‡∏≤‡πÄ‡∏Ç‡πâ‡∏° (‡∏Å‡∏î‡πÅ‡∏•‡πâ‡∏ß‡∏à‡∏°‡∏•‡∏á) */
                -6px -6px 12px var(--shadow-light); /* ‡πÄ‡∏á‡∏≤‡∏ö‡∏ô‡∏ã‡πâ‡∏≤‡∏¢‡∏™‡∏ß‡πà‡∏≤‡∏á (‡∏¢‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô) */
}

/* Style for Export Button specifically */
#exportExcel {
    background-color: #d1e7dd; /* ‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡∏≠‡πà‡∏≠‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏° Export (‡∏õ‡∏£‡∏±‡∏ö‡πÉ‡∏´‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏Å‡∏±‡∏ö‡∏ò‡∏µ‡∏°) */
    color: #285430; /* ‡∏™‡∏µ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏°‡∏Ç‡∏∂‡πâ‡∏ô */
    box-shadow: 6px 6px 12px #a7a7a7, /* ‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏≤‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏´‡πá‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏ï‡∏Å‡∏ï‡πà‡∏≤‡∏á‡∏Å‡∏±‡∏ö neumorphism ‡πÇ‡∏î‡∏¢‡∏£‡∏ß‡∏° */
                -6px -6px 12px #ffffff;
}

/* Hover effect */
#exportExcel:hover {
    background-color: #c0dbc2; /* ‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡∏≠‡πà‡∏≠‡∏ô‡∏•‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠ hover */
    box-shadow: 4px 4px 8px #a7a7a7,
                -4px -4px 8px #ffffff;
    transform: translateY(-2px); /* ‡∏¢‡∏Å‡∏õ‡∏∏‡πà‡∏°‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢ */
}

/* Active (clicked) effect */
#exportExcel:active {
    background-color: #acd8ae; /* ‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡πÄ‡∏Ç‡πâ‡∏°‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ñ‡∏π‡∏Å‡∏Å‡∏î */
    box-shadow: inset 2px 2px 5px #a7a7a7, /* ‡πÄ‡∏á‡∏≤‡∏î‡πâ‡∏≤‡∏ô‡πÉ‡∏ô ‡πÉ‡∏´‡πâ‡∏î‡∏π‡∏à‡∏°‡∏•‡∏á */
                inset -3px -3px 7px #ffffff;
    transform: translateY(0); /* ‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÄ‡∏î‡∏¥‡∏° */
}

/* Optional: Add an icon to the button */
#exportExcel::before {
    content: 'üìä'; /* Unicode for a chart/spreadsheet icon */
    font-size: 1.1em;
    margin-right: 5px;
}
/* --- End New Button Styles --- */


/* Responsive adjustments */
@media (max-width: 768px) {
    .container {
        padding: var(--spacing);
    }

    .controls {
        grid-template-columns: 1fr; /* Stack controls on small screens */
    }

    .rate-summary-container {
        grid-template-columns: 1fr; /* Stack summary boxes */
    }

    th, td {
        padding: 8px 10px;
        font-size: 0.9em;
    }
}